<section>
    <h2><b>Geomorphometry II:</b></h2>
    <h3><b>Basic topographic analysis</b></h3>
    <p style="margin-top: 0.5em">
        Helena Mitasova</p>
    <p class="title-foot">
        GIS/MEA582 Geospatial Modeling and Analysis
        <a href="http://www.ncsu.edu/" title="North Carolina State University">NCSU</a>
    </p>
</section>

<section>
    <h3>Outline (learning objectives)</h3>
<p>
<ul>
  <li>summary parameters: volumes, surface areas
  <li>first and second order point parameters 
  <li>methods for slope, aspect and curvatures using polynomial and spline approximation
  <li>computing parameters from noisy data, level of detail 
  <li>combining parameters to map landforms and terrain features
</ul>
</section>

<section>
  <h3>Terrain surface  parameters</h3>
<ul>
<li class="fragment">Derived  from discrete representation of $z=f(x,y)$
<p>
<li class="fragment"><b>Summary parameters</b>
  quantify property for entire surface or its subregion: volume, surface area, fractal dimension, roughness
<li class="fragment"><b>Point geometry parameters</b> quantify geometry at each point of the surface: gradient, curvatures
<li class="fragment"><b>Process-based parameters</b> quantify cumulative results of processes (flow, solar radiation, wetness)
</ul>
</section>

<section>
   <h3>Volume estimation</h3>
<ul>
<li> Volume - integral approximated as sum of cuboids:
$$
V=∑dx.dy.dz = dx.dy ∑ dz
$$
<li class="fragment">where $dx.dy$ is grid cell area, $dz = z_0-z_i$, is cell value difference, $z_0$ is constant, plane or curved surface
<li class="fragment">computed as sum of grid cell values 
<li class="fragment">can be applied as global or zonal metrics
</ul>
<p>
 <img height="300" src="img/topoanalysis/volume_dz.png">
</p>
</section>

<section>
   <h3>Surface area</h3>
<ul>
<li class="fragment">sum of 3D triangle areas, depending on the direction of the diagonal: minimum and maximum surface 
<li class="fragment"> alternative: 8 triangles connecting grid center with neighboring ones 
<li class="fragment"> larger than 2D area 
</ul>
<p>
 <img height="300" src="img/analysis_basicraster/surfacearea2.jpg">
</p>
</section>

<section>
   <h3>Point topographic parameters</h3>
<p>
Measure geometric properties at any point of the topographic surface
<ul>
<li class="fragment">steepness, orientation, and shape 
<li class="fragment">derivation based on differential geometry
<li class="fragment">computed from raster DEM using elevation differencing
<li class="fragment">computed directly from scattered points using interpolation function with suitable properties
</ul>
</section>

<section>
   <h3>Elevation surface gradient</h3>
Given a surface  $z = f(x,y)$, where $f(x,y)$ is a continuous bivariate function,
we can define a gradient: 
<p class="fragment">
$$ 
\nabla z = ({\partial z \over \partial x}, {\partial z \over \partial y}) = (f_x,f_y)
$$
<p class="fragment">
where $f_x$ and $f_y$ are first order partial derivatives of $f(x,y)$ 
<p class="fragment">
vector field that represents the <b>maximum rate of change</b> in elevation 
and points in the direction of this change
<p>
<small><a href="https://www.khanacademy.org/math/multivariable-calculus/multivariable-derivatives/partial-derivatives/v/partial-derivatives-introduction">
What is partial derivative</a> and a
<a href="https://www.khanacademy.org/math/multivariable-calculus/multivariable-derivatives/partial-derivatives/v/formal-definition-of-partial-derivatives">
formal definition</a> and
<a href="https://www.khanacademy.org/math/multivariable-calculus/multivariable-derivatives/gradient-and-directional-derivatives/v/why-the-gradient-is-the-direction-of-steepest-ascent">why it is direction of steepest ascent</a>
</small>
</section>

<section>
   <h3>Gradient vector field</h3>
$$
\nabla z = - (f_x,f_y)
$$
<p class="fragment"> <img height="400" src="img/topoanalysis/gradient_elev.png">
<p class="fragment"> gradient vectors are perpendicular to contours
</section>

<section>
   <h3>Steepest slope angle</h3>
Given the surface gradient $\nabla z = (f_x,f_y)$, 
the steepest slope magnitude $s[\%]$ is the gradient vector magnitude
<p class="fragment">
$$ s = 100 \sqrt {f_x^2 + f_y^2} $$
<p class="fragment">
and the steepest slope angle $\gamma$ is 
<p class="fragment">
$$ \tan \gamma = \sqrt{f_x^2 + f_y^2} $$
<ul>
<li class="fragment"> angle between horizontal plane and surface tangent, 
<li class="fragment"> rise over run in direction of max elevation change
</ul>
<p class="fragment">
<small>keep in mind that 
$$ (f_x,f_y)=({\partial z \over \partial x}, {\partial z \over \partial y})$$
</small>
</section>

<section>
   <h3>Steepest slope angle map</h3>
$$ \gamma = \arctan \sqrt {f_x^2 + f_y^2} $$
<p class="fragment"> <img height="380" src="img/topoanalysis/slopearrows.png">
<ul>
<li class="fragment">values range between 0 - 90 degrees
<li class="fragment">controls flow velocity and sun inclination angle
</ul>
</section>

<section>
   <h3>Aspect angle </h3>
Steepest slope <b>direction</b> angle is given by the direction of gradient vector
<p class="fragment">
$$ \tan \alpha = {f_y \over f_x} $$
<ul>
<li class="fragment"> values range between 0 - 360 degrees
<li class="fragment"> signs of $f_x, f_y$ need to be taken into account to determine the angle in relation to
the 0 deg direction (E or N)
 <li class="fragment">measures hillslope orientation
 <li class="fragment">controls flow direction and sun inclination angle
</ul>
<p class="fragment"><small>
 when only $f_x = 0, \tan \alpha = \inf$ and $\alpha = 90 \deg$, but when $f_x = f_y = 0$ then $\alpha$ is undefined  
</small>
</section>

<section>
   <h3>Aspect angle map</h3>
$$ \tan \alpha = f_y / f_x $$
<p class="fragment"> <img height="320" src="img/analysis_basicraster/surfacearea2.jpg">
</section>

<section>
   <h3>Slope angle in a given direction</h3>
Slope $\gamma_t$ measured at <b>a direction</b> $\alpha_t$ id given as:
$$ \gamma_t = \gamma \cos(\alpha - \alpha_t) $$
<ul>
<li> where $\gamma$ is the steepest slope angle.
<li> $\alpha$ is  the steepest slope direction 
</ul>
<p class="fragment">Slope angle $\gamma_t$ is always smaller than $\gamma$
<p>add diagram
<p class="fragment"> <small>Directional derivative: ${\partial z \over \partial s} = f_x \cos \alpha_t + f_y \sin \alpha_t$
</small>

</section>

<section>
   <h3>Slope angle in a road direction</h3>
Slope along the road , versus steepest slope angle
<p class="fragment"> <img height="320" src="img/analysis_basicraster/surfacearea2.jpg">
</section>

<section>
   <h3>Slope and aspect from DEM </h3>
Given a matrix of elevation values - a DEM, estimate slope and aspect:
<ul>
  <li class="fragment">Steepest elevation difference: D8 approach
  <li class="fragment">Polynomial approximation on 3x3 neighborhood, many versions using second order polynomials
  <li class="fragment">Spline approximation on raster or directly from point data
</ul>
</section>

<section>
   <h3>Slope and aspect from DEM </h3>
Polynomial approximation on 3x3 moving window:
$$ z(x,y)=a_0+a_1 x + a_2 y + a_3 xy + a_4 x^2 + a_5 y^2 $$
<ul>
   <li class="fragment">we can write 9 equations to solve for $a_i$ parameters 
   <li class="fragment">more equations than needed - we use weighted least squares to fit the polynomial to the 9 grid points
  <li class="fragment"> the solution leads to - ADD
</ul>
<p>window image <img height="320" src="img/analysis_basicraster/surfacearea2.jpg">
</section>

<section>
   <h3>Slope and aspect from DEM </h3>
<!--Now we can compute $f_x$ and $f_y$: $$f_x = a_1 + a_3y + 2a_4x, f_y = a_2 + a_3x + 2a_4y$$-->
After substitution for $a_i$ we get

$$
f_x = {{(z_{i-1,j-1} - z_{i+1,j-1}) + 2(z_{i-1,j} - z_{i+1,j}) + (z_{i-1,j+1} -z_{i+1,j+1})} \over {8 \Delta x}} 
$$

$$
f_y = {{(z_{i-1,j-1} - z_{i-1,j+1}) + 2(z_{i,j-1} - z_{i,j+1}) + (z_{i+1,j-1} -z_{i+1,j+1})} \over {8 \Delta y}} 
$$
Then slope and aspect is $ \tan \gamma = \sqrt{f_x^2 + f_y^2}, \tan \alpha = f_y / f_x$
<p>window image <img height="300" src="img/analysis_basicraster/surfacearea2.jpg">
</section>

<section>
   <h3>Steepest slope and aspect: DEM </h3>
Slope and aspect derived from a 10m resolution DTM
<p class="fragment"> <img height="320" src="img/data_visualize/slope.png">
<p class="fragment"> <img height="320" src="img/data_visualize/slope.png">
</section>

<section>
   <h3>Slope and aspect: integer DEM </h3>
Impact of integer elevation values in meters on slope pattern
and a slope and aspect histograms
<p class="fragment"> <img height="320" src="img/analysis_basicraster/surfacearea2.jpg">
</section>

<section>
   <h3>Computing slope and aspect from points </h3>
Given a set of scattered points, estimate slope and aspect:
<ul>
  <li class="fragment">Spline approximation on raster or directly from point data
</ul>
</section>

<section>
   <h3>Steepest slope and aspect: DSM </h3>
Slope and aspect derived from lidar 1st return point cloud using RST method
(smoothing spline with tension)
<p class="fragment"> <img height="320" src="img/analysis_basicraster/surfacearea2.jpg">
</section>

<section>
   <h3>Surface curvatures</h3>
Curvature at a point: inverse of the radius of a circle tangent to the surface at this point in a given direction [m-1]
Convex, concave, high value - smaller circle
<p class="fragment"> <img height="320" src="img/analysis_basicraster/surfacearea2.jpg">
</section>

<section>
   <h3>Surface curvatures</h3>
<ul>
  <li class="fragment">In general, surface has different curvatures in different directions
<li class="fragment">Principal directions have max and min curvatures, gaussian and mean are function of principal curvatures
<li class="fragment">Geomorphometric curvatures: profile, tangential / plan
</ul>
</section>

<section>
   <h3>Learn more</h3>
Find more examples in the 2014 lecture, MEA592-004/GIS595-002:
Multidimensional Geospatial Modeling material and GIS595 UAS course
</section>

<section>
   <h3>Summary</h3>
</section>

<div class="parent-page">
    <!-- &#x1f3e0; -->
    <a href="http://ncsu-geoforall-lab.github.io/geospatial-modeling-course/" title="Go to the course page">&#8962;</a>
</div>
